<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Theoreme de Pythagore</title>

<!-- Polices -->
<link href="https://fonts.googleapis.com/css2?family=Androgy+Demo&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Mabry+Pro&display=swap" rel="stylesheet" />

<style>
:root {
  --primary-color: #3a86ff;
  --secondary-color: #8338ec;
  --background-color: #f0f4f8;
  --text-color: #212529;
  --border-radius: 10px;
  --transition: 0.3s ease;
}

body {
  font-family: 'Mabry Pro', sans-serif;
  background: var(--background-color);
  color: var(--text-color);
  margin: 2rem;
  user-select: none;
  text-align: center;
}

h1 {
  font-family: 'Androgy Demo', sans-serif;
  font-size: 2.5rem;
  color: var(--primary-color);
  margin-bottom: 2rem;
}

.container {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 3rem;
  flex-wrap: wrap;
}

figure {
  background: white;
  border-radius: var(--border-radius);
  padding: 1rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

figcaption {
  margin-top: 0.5rem;
  font-weight: bold;
}

#text-area {
  background: white;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  text-align: left;
  width: 320px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

span.editable {
  border-bottom: 2px dotted var(--primary-color);
  cursor: text;
  display: inline-block;
  min-width: 40px;
}

button {
  margin-top: 1rem;
  padding: 0.6rem 1.2rem;
  background-color: var(--primary-color);
  border: none;
  color: white;
  font-weight: bold;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: background-color var(--transition);
}
button:hover {
  background-color: #2a68cc;
}

#feedback {
  font-weight: bold;
  margin-top: 1rem;
}
</style>
</head>

<body>
<h1>Theoreme de Pythagore</h1>

<div class="container">
  <figure>
    <svg width="220" height="180">
      <polygon id="triangle" points="40,140 160,140 40,40" fill="none" stroke="#3a86ff" stroke-width="3"/>
      <text x="30" y="40" font-size="16" fill="#212529">A</text>
      <text x="165" y="145" font-size="16" fill="#212529">C</text>
      <text x="25" y="150" font-size="16" fill="#212529">B</text>
      <text id="AB" x="10" y="90" font-size="14" fill="#212529"></text>
      <text id="BC" x="90" y="155" font-size="14" fill="#212529"></text>
      <text id="AC" x="110" y="80" font-size="14" fill="#212529"></text>
    </svg>
    <figcaption>Triangle ABC rectangle en B</figcaption>
  </figure>

  <div id="text-area"></div>
</div>

<div id="feedback"></div>

<button onclick="checkAnswers()">Vérifier</button>

<script>
const textArea = document.getElementById('text-area');
const feedback = document.getElementById('feedback');
const sideAB = document.getElementById('AB');
const sideBC = document.getElementById('BC');
const sideAC = document.getElementById('AC');

let correctValues = {};
let userValues = {};

function generateExercise() {
  const AB = (Math.random() * 2 + 1).toFixed(1); // 1.0 à 3.0
  const BC = (Math.random() * 3 + 2).toFixed(1); // 2.0 à 5.0
  const AC = Math.sqrt(AB**2 + BC**2).toFixed(1);

  // Calculs corrects
  const AB2 = (AB ** 2).toFixed(2);
  const BC2 = (BC ** 2).toFixed(2);
  const AC2 = (AC ** 2).toFixed(2);
  const sum = (parseFloat(AB2) + parseFloat(BC2)).toFixed(2);

  correctValues = { AB, BC, AC, AB2, BC2, AC2, sum };

  // Générer des erreurs aléatoires
  const err = (val) => (Math.random() < 0.5 ? (parseFloat(val) + (Math.random()*1-0.5)).toFixed(2) : val);

  const texte = `
  Le triangle ABC est rectangle en B.<br>
  D’après le théorème de Pythagore,<br>
  on a : <br>
  AC² = AB² + BC²<br>
  AC² = <span class="editable" contenteditable>${err(AB)}²</span> + <span class="editable" contenteditable>${err(BC)}²</span><br>
  AC² = <span class="editable" contenteditable>${err(AB2)}</span> + <span class="editable" contenteditable>${err(BC2)}</span><br>
  AC² = <span class="editable" contenteditable>${err(sum)}</span><br>
  AC = √<span class="editable" contenteditable>${err(sum)}</span><br>
  AC = <span class="editable" contenteditable>${err(AC)}</span> m<br>
  <br>
  La longueur AC est de <span class="editable" contenteditable>${err(AC)}</span> m.
  `;

  textArea.innerHTML = texte;

  sideAB.textContent = `AB = ${AB} m`;
  sideBC.textContent = `BC = ${BC} m`;
  sideAC.textContent = `AC = ?`;

  feedback.textContent = '';
}

function checkAnswers() {
  const edits = Array.from(document.querySelectorAll('.editable'));
  let correct = 0;

  edits.forEach(span => {
    const val = span.textContent.replace(/[^\d.,]/g, '');
    userValues[span] = val;

    // Vérifier si proche de l'une des bonnes valeurs
    const isClose = Object.values(correctValues).some(c => Math.abs(parseFloat(c) - parseFloat(val)) < 0.1);
    if (isClose) {
      span.style.color = 'green';
      correct++;
    } else {
      span.style.color = 'red';
    }
  });

  feedback.textContent = correct === edits.length ? "✅ Bravo, tout est juste !" : "❌ Il y a des erreurs à corriger.";
}

generateExercise();
</script>
</body>
</html>
