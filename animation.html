<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Calcul d'Aire - Formules</title>

<!-- Polices -->
<link href="https://fonts.googleapis.com/css2?family=Androgy+Demo&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Mabry+Pro&display=swap" rel="stylesheet" />

<style>
:root{
  --primary-color: #3a86ff;
  --background-color: #f0f4f8;
  --yellow: #fff3b0;
  --pink: #fbb1bd;
  --border-radius: 10px;
  --transition: 0.25s ease;
  --text-color: #212529;
}

*{box-sizing:border-box;}
body{
  font-family:'Mabry Pro',sans-serif;
  background:var(--background-color);
  margin:0;
  padding:2rem;
  text-align:center;
  color:var(--text-color);
}
h1{
  font-family:'Androgy Demo',sans-serif;
  font-size:2.4rem;
  color:var(--primary-color);
  margin-bottom:1.5rem;
}

/* FIGURES */
#figure{
  position:relative;
  width:240px;
  height:200px;
  margin:2rem auto;
  background:var(--background-color);
}
.shape{
  position:absolute;
  opacity:0.9;
}
.square{
  width:100px; height:100px;
  background:var(--pink);
}
.rectangle{
  width:140px; height:80px;
  background:var(--pink);
}
.circle{
  width:100px; height:100px;
  border-radius:50%;
  background:var(--pink);
}
.triangle{
  width: 0; height: 0;
  border-left: 60px solid transparent;
  border-right: 60px solid transparent;
  border-bottom: 100px solid var(--pink);
}
.half-circle{
  width:100px; height:50px;
  background:var(--pink);
  border-top-left-radius:100px;
  border-top-right-radius:100px;
}

/* FIGURE COMPOSÉE (JAUNE) */
.composed{
  background:var(--yellow);
  border-radius:var(--border-radius);
}

/* DRAG & DROP */
.vignettes, .dropzone{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:0.75rem;
  margin:1rem auto;
}
.vignette{
  padding:0.6rem 1rem;
  background:white;
  border:2px solid var(--primary-color);
  border-radius:var(--border-radius);
  cursor:grab;
  transition:transform var(--transition), background var(--transition);
  font-weight:600;
}
.vignette:hover{
  background:var(--primary-color);
  color:white;
  transform:scale(1.05);
}
.dropzone{
  border:2px dashed #ccc;
  min-height:60px;
  background:white;
  border-radius:var(--border-radius);
  padding:1rem;
}
.dropzone.over{
  border-color:var(--primary-color);
  background:#eaf2ff;
}

/* BOUTON + FEEDBACK */
.btn{
  padding:0.6rem 1.2rem;
  border:none;
  border-radius:var(--border-radius);
  background:var(--primary-color);
  color:white;
  cursor:pointer;
  font-family:inherit;
  font-size:1rem;
  margin-top:1rem;
}
.btn:hover{background:#8338ec;}
.feedback{
  margin-top:0.75rem;
  font-weight:bold;
}
.feedback.ok{color:green;}
.feedback.bad{color:red;}
</style>
</head>
<body>

<h1>Calcul d'Aire</h1>

<div id="figure"></div>

<div class="vignettes">
  <div class="vignette" draggable="true" data-value="Aire carré">Aire carré</div>
  <div class="vignette" draggable="true" data-value="Aire rectangle">Aire rectangle</div>
  <div class="vignette" draggable="true" data-value="Aire cercle">Aire cercle</div>
  <div class="vignette" draggable="true" data-value="Aire triangle">Aire triangle</div>
  <div class="vignette" draggable="true" data-value="Aire demi-cercle">Aire demi-cercle</div>
  <div class="vignette" draggable="true" data-value="+">+</div>
  <div class="vignette" draggable="true" data-value="-">−</div>
</div>

<h3>Compose la formule :</h3>
<div class="dropzone" id="dropzone"></div>

<button class="btn" id="validateBtn">Valider</button>
<div class="feedback" id="feedback"></div>

<script>
const figureEl = document.getElementById('figure');
const dropzone = document.getElementById('dropzone');
const feedback = document.getElementById('feedback');
const validateBtn = document.getElementById('validateBtn');

const combos = [
  { shapes: ['square','triangle'], op: '+', formula: 'Aire carré + Aire triangle' },
  { shapes: ['rectangle','half-circle'], op: '+', formula: 'Aire rectangle + Aire demi-cercle' },
  { shapes: ['rectangle','circle'], op: '-', formula: 'Aire rectangle − Aire cercle' },
  { shapes: ['square','circle'], op: '-', formula: 'Aire carré − Aire cercle' }
];

let currentCombo = null;

/* --- Génération de la figure --- */
function generateFigure(){
  figureEl.innerHTML = '';
  dropzone.innerHTML = '';
  feedback.textContent = '';
  
  currentCombo = combos[Math.floor(Math.random()*combos.length)];

  currentCombo.shapes.forEach((shape,i)=>{
    const el = document.createElement('div');
    el.classList.add('shape','composed',shape);
    el.style.left = (i*40)+'px';
    el.style.top = (i*20)+'px';
    el.style.opacity = 0.8;
    figureEl.appendChild(el);
  });
}

/* --- Drag & Drop --- */
document.querySelectorAll('.vignette').forEach(v=>{
  v.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('text/plain', v.dataset.value);
  });
});

dropzone.addEventListener('dragover', e=>{
  e.preventDefault();
  dropzone.classList.add('over');
});
dropzone.addEventListener('dragleave', ()=>dropzone.classList.remove('over'));
dropzone.addEventListener('drop', e=>{
  e.preventDefault();
  dropzone.classList.remove('over');
  const val = e.dataTransfer.getData('text/plain');
  const item = document.createElement('div');
  item.textContent = val;
  item.classList.add('vignette');
  item.style.cursor='default';
  item.draggable=false;
  dropzone.appendChild(item);
});

/* --- Validation --- */
validateBtn.addEventListener('click', ()=>{
  const answer = Array.from(dropzone.children).map(el=>el.textContent.trim()).join(' ');
  if(normalize(answer) === normalize(currentCombo.formula)){
    feedback.textContent = '✅ Bravo, c’est correct !';
    feedback.className = 'feedback ok';
  } else {
    feedback.textContent = `❌ Réponse attendue : ${currentCombo.formula}`;
    feedback.className = 'feedback bad';
  }
  setTimeout(generateFigure, 3000);
});

function normalize(str){return str.toLowerCase().replace(/\s+/g,' ').trim();}

generateFigure();
</script>

</body>
</html>
