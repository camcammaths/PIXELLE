<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Developpe </title>

<!-- Polices -->
<link href="https://fonts.googleapis.com/css2?family=Androgy+Demo&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Mabry+Pro&display=swap" rel="stylesheet" />

<style>
:root {
  --primary-color: #3a86ff;
  --secondary-color: #8338ec;
  --background-color: #f0f4f8;
  --button-bg: #a8d0ff;
  --button-bg-hover: #7ab3ff;
  --correct: #4CAF50;
  --incorrect: #e74c3c;
  --text-color: #212529;
  --border-radius: 8px;
  --transition: 0.3s ease;
}

body {
  font-family: 'Mabry Pro', sans-serif;
  background: var(--background-color);
  margin: 0;
  padding: 2rem;
  text-align: center;
  color: var(--text-color);
}

h1 {
  font-family: 'Androgy Demo', sans-serif;
  font-size: 2.5rem;
  color: var(--primary-color);
  margin-bottom: 1.5rem;
}

#expression {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  font-weight: bold;
}

#slots, #palette {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  justify-content: center;
  margin-bottom: 1.5rem;
}

.slot, .brick {
  padding: 0.75rem 1rem;
  min-width: 80px;
  border-radius: var(--border-radius);
  font-weight: bold;
  text-align: center;
  cursor: grab;
  transition: all var(--transition);
  user-select: none;
  background: white;
  border: 2px solid var(--primary-color);
}

.slot {
  min-height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.slot.correct { background-color: var(--correct); color: white; border-color: var(--correct); }
.slot.incorrect { background-color: var(--incorrect); color: white; border-color: var(--incorrect); }

.brick.dragging { opacity: 0.5; transform: scale(0.98); }
.brick:hover { transform: scale(1.05); }

.btn {
  font-family: 'Mabry Pro', sans-serif;
  font-size: 1rem;
  padding: 0.6rem 1.2rem;
  margin: 0.3rem;
  background-color: var(--button-bg);
  border: none;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: background-color var(--transition);
}

.btn:hover { background-color: var(--button-bg-hover); color: white; }

a.back {
  display: inline-block;
  margin-top: 2rem;
  text-decoration: none;
  font-weight: 600;
  color: var(--primary-color);
  border: 2px solid var(--primary-color);
  padding: 0.5rem 1rem;
  border-radius: var(--border-radius);
  transition: background-color var(--transition), color var(--transition);
}

a.back:hover {
  background-color: var(--primary-color);
  color: white;
}

#feedback {
  font-weight: bold;
  margin-bottom: 1rem;
}
</style>
</head>
<body>

<h1>Développement — Pose les briques</h1>

<div id="expression">a(x + b)</div>

<div id="slots"></div>
<div id="palette"></div>

<div id="feedback"></div>

<button class="btn" onclick="checkAnswer()">Vérifier</button>
<button class="btn" onclick="nextQuestion()">Nouvelle expression</button>
<br>
<a href="index.html" class="back">← Retour à l'accueil</a>

<script>
const expressionEl = document.getElementById('expression');
const slotsEl = document.getElementById('slots');
const paletteEl = document.getElementById('palette');
const feedbackEl = document.getElementById('feedback');

let currentTerms = [];
let dragged = null;

function generateQuestion() {
  const a = Math.floor(Math.random()*5)+2;
  const b = Math.floor(Math.random()*5)+1;
  const sign = Math.random()<0.5?'+':'-';
  const expr = `${a}(x ${sign} ${b})`;
  const constTerm = sign==='+' ? a*b : -a*b;
  const terms = [`${a}x`, `${constTerm}`];
  return {expr, terms};
}

function renderQuestion() {
  const q = generateQuestion();
  currentTerms = q.terms;
  expressionEl.textContent = q.expr;
  slotsEl.innerHTML = '';
  paletteEl.innerHTML = '';

  q.terms.forEach(term=>{
    const slot = document.createElement('div');
    slot.className='slot';
    slot.dataset.expect = term;
    slot.addEventListener('dragover', e=>e.preventDefault());
    slot.addEventListener('drop', onDrop);
    slotsEl.appendChild(slot);
  });

  const bricks = [...q.terms, `${Math.floor(Math.random()*10)+1}`];
  bricks.sort(()=>Math.random()-0.5);

  bricks.forEach((t,i)=>{
    const brick = document.createElement('div');
    brick.className='brick';
    brick.textContent = t;
    brick.draggable = true;
    brick.addEventListener('dragstart', e=>{dragged=e.target; e.target.classList.add('dragging');});
    brick.addEventListener('dragend', e=>e.target.classList.remove('dragging'));
    paletteEl.appendChild(brick);
  });

  feedbackEl.textContent = '';
}

function onDrop(e){
  e.preventDefault();
  const slot = e.currentTarget;
  if(slot.firstChild){ paletteEl.appendChild(slot.firstChild); }
  slot.appendChild(dragged);
}

function checkAnswer(){
  let correct = true;
  Array.from(slotsEl.children).forEach(slot=>{
    const expected = slot.dataset.expect;
    const actual = slot.firstChild ? slot.firstChild.textContent : null;
    if(actual===expected){
      slot.classList.add('correct'); slot.classList.remove('incorrect');
    } else {
      slot.classList.add('incorrect'); slot.classList.remove('correct');
      correct=false;
    }
  });
  feedbackEl.textContent = correct ? 'Bravo ✅' : 'Des erreurs ❌';
}

function nextQuestion(){ renderQuestion(); }

nextQuestion();
</script>

</body>
</html>
